
<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ูุฑุงุณู ุนุจุฏ ุงูุนุฒูุฒ ูููุงุชุณุงุจ</title>
    <link rel="stylesheet" href="style.css">
    <link rel="manifest" href="manifest.json">
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.5.0/css/flag-icon.min.css">
    <link rel="shortcut icon" href="whatsapp-icon.png" type="image/png">
</head>
<body>
    <div class="container">
        
        <div class="profile-header">
            <img src="profile-pic.png" alt="ุตูุฑุฉ ุงูููู ุงูุชุนุฑููู" class="profile-img">
            <h1>ุนุจุฏ ุงูุนุฒูุฒ</h1>
            <p class="description">ูุฑุงุณู ุงููุงุชุณุงุจ ุงูุณูุฏุงูู ุงูููุฑู! ุฃุณุฑุน ุทุฑููุฉ ููุชูุงุตู ูุน ุงูุฃุบุฑุงุจ ูู ุดุบููุง ุงููููู. ูุง ุชุถููุน ุฒููู ูู ุญูุธ ุฑูู ุฌุฏูุฏ.</p>
        </div>

        <h2 class="title">ุฅุฑุณุงู ุฑุณุงูุฉ ูุจุงุดุฑุฉ</h2>
        
        <button id="installButton" class="install-prompt-button" style="display: none;">
            ๐ฒ ุชุซุจูุช ูุชุทุจูู ุนูู ุดุงุดุชู
        </button>
        <div class="input-group">
            <label for="countryCode">ุงุฎุชุฑ ุงูุฏููุฉ ุฃู ุฏุนูุง ููุชุดููุง ูู:</label>
            <select id="countryCode" onchange="updateFlagAndCode(this.value)">
                <option value="" disabled selected>... ุฌุงุฑู ุงูุจุญุซ ุนู ูููุนู ุฃู ุงุฎุชุฑ ูุฏููุงู</option>
            </select>
        </div>

        <div class="input-group phone-group">
            <div class="country-info">
                <span id="currentFlag" class="flag-icon flag-icon-sd"></span>
                <span id="currentCode" class="code-placeholder">+249</span>
            </div>
            <input type="tel" id="phoneInput" placeholder="ุฃุฏุฎู ุงูุฑูู ุงููุญูู (ุจุฏูู ุงูุฑูุฒ)" inputmode="numeric">
        </div>

        <button onclick="openWhatsApp()">
            <img src="whatsapp-icon.png" alt="WhatsApp Icon" class="icon"> ุจุฏุก ุงููุญุงุฏุซุฉ ุงูุขู
        </button>

        <p class="note">ูุฑุฌู ุงูุชุฃูุฏ ูู ุฃู ุฑูุฒ ุงูุฏููุฉ ุงูุธุงูุฑ ุตุญูุญ ูุจู ุฅุฏุฎุงู ุงูุฑูู ุงููุญูู.</p>
    </div>

    <footer class="app-footer">
        <p>ุฌููุน ุงูุญููู ูุญููุธุฉ &copy; 2025. ุนุจุฏ ุงูุนุฒูุฒ</p>
        <p>
            ุฅุฐุง ูุงุฌูุชู ูุดููุฉ:
            <a href="https://linktr.ee/abdul3ziz95" target="_blank" class="contact-link">ุงุชุตู ุจู</a>
        </p>
    </footer>

    <script>
        // ุงููุชุบูุฑ ูุชุฎุฒูู ุญุฏุซ ุงูุชุซุจูุช
        let deferredPrompt; 
        
        // ุฑุจุท ุงูุฒุฑ
        const installButton = document.getElementById('installButton');

        // ************** ููุทู ุงูุชุซุจูุช ุงูููุจุซู (Install Prompt Logic) **************
        window.addEventListener('beforeinstallprompt', (e) => {
            // ููุน ุงููุชุตูุญ ูู ุฅุธูุงุฑ ุงููุงูุฐุฉ ุงูุชููุงุฆูุฉ
            e.preventDefault();
            // ุชุฎุฒูู ุงูุญุฏุซ ูุงุณุชุฎุฏุงูู ูุงุญูุงู (ุนูุฏ ุงูุถุบุท ุนูู ุงูุฒุฑ)
            deferredPrompt = e; 
            // ุฅุธูุงุฑ ุงูุฒุฑ ุงููุฎุตุต ููุชุซุจูุช
            installButton.style.display = 'block';
        });

        installButton.addEventListener('click', (e) => {
            // ุฅุฎูุงุก ุฒุฑูุง ุจุนุฏ ุงูุถุบุท ุนููู
            installButton.style.display = 'none';

            if (deferredPrompt) {
                // ุฅุธูุงุฑ ุงููุงูุฐุฉ ุงูููุจุซูุฉ ุงูุฃุตููุฉ ูููุชุตูุญ
                deferredPrompt.prompt();
                
                deferredPrompt.userChoice.then((choiceResult) => {
                    if (choiceResult.outcome === 'accepted') {
                        console.log('ุงููุณุชุฎุฏู ูุงูู ุนูู ุงูุชุซุจูุช');
                    } else {
                        console.log('ุงููุณุชุฎุฏู ุฑูุถ ุงูุชุซุจูุช');
                    }
                    deferredPrompt = null; // ุชูุฑูุบ ุงูุญุฏุซ ุจุนุฏ ุงูุงุณุชุฎุฏุงู
                });
            } else {
                // ุฑุณุงูุฉ ุฅุฑุดุงุฏูุฉ ูุฃุฌูุฒุฉ iOS ุฃู ุงูุฃุฌูุฒุฉ ุงูุชู ูุง ุชุฏุนู ุงูุญุฏุซ
                alert('ูุชุซุจูุช ุงูุชุทุจูู: ุงูุชุญ ูุงุฆูุฉ ุงููุชุตูุญ (โฎ) ูุงุฎุชุฑ "ุงูุชุซุจูุช" ุฃู "ุฅุถุงูุฉ ุฅูู ุงูุดุงุดุฉ ุงูุฑุฆูุณูุฉ".');
            }
        });
        // *******************************************************************
        
        // ูุตูููุฉ ุงูุฏูู (ุชู ุญุฐููุง ูุชุฌูุจ ุงูุชูุฑุงุฑุ ุงุณุชุฎุฏู ุงูููุฏ ุงูุณุงุจู)
        const countryData = [
            // ... (ุงุณุชุฎุฏู ููุณ ูุตูููุฉ ุงูุฏูู ูู ุงูููุฏ ุงูุณุงุจู)
            { name: 'ุงูููููุฉ ุงูุนุฑุจูุฉ ุงูุณุนูุฏูุฉ', code: '966', iso: 'sa' },
            { name: 'ุงูุณูุฏุงู', code: '249', iso: 'sd' },
            // ... ูุจุงูู ุงูุฏูู
        ];
        
        const selectElement = document.getElementById('countryCode');
        const currentFlagSpan = document.getElementById('currentFlag');
        const currentCodeSpan = document.getElementById('currentCode');
        
        // (ุจุงูู ูุธุงุฆู populateCountries, updateFlagAndCode, fetchUserCountry, openWhatsApp ุชุจูู ููุง ูู)
        
        // ... (ููุง ูุชู ุฅุฏุฑุงุฌ ุจููุฉ ููุฏ JavaScript ุงูุฐู ููุชูู ุจู populateCountries() ู fetchUserCountry())
        
        function populateCountries() {
            countryData.sort((a, b) => a.name.localeCompare(b.name, 'ar'));
            
            countryData.forEach(country => {
                const option = document.createElement('option');
                option.value = country.code;
                option.setAttribute('data-iso', country.iso);
                option.textContent = `(${country.code}+) ${country.name}`;
                selectElement.appendChild(option);
            });
            selectElement.value = '249'; 
            updateFlagAndCode('249');
        }

        function updateFlagAndCode(code) {
            const country = countryData.find(c => c.code === code);
            if (country) {
                currentCodeSpan.textContent = `+${country.code}`;
                currentFlagSpan.className = `flag-icon flag-icon-${country.iso}`;
                selectElement.value = code;
            }
        }

        async function fetchUserCountry() {
            try {
                const response = await fetch('https://ipapi.co/json/');
                const data = await response.json();
                const userIso = data.country_code.toLowerCase();
                const detectedCountry = countryData.find(c => c.iso === userIso);
                if (detectedCountry) {
                    updateFlagAndCode(detectedCountry.code);
                }
            } catch (error) {
                console.error('ูุดู ูู ุฌูุจ ุงููููุน ุงูุฌุบุฑุงูู ุงูุชููุงุฆู.');
            }
        }

        function openWhatsApp() {
            const code = currentCodeSpan.textContent.replace('+', '');
            const localNumber = document.getElementById('phoneInput').value.trim().replace(/[\s+-]/g, '');

            if (!localNumber || localNumber.length < 6) {
                alert('ุงูุฑุฌุงุก ุฅุฏุฎุงู ุฑูู ูุงุชู ูุญูู ุตุงูุญ.');
                return;
            }

            const fullNumber = code + localNumber;
            const whatsappLink = 'https://wa.me/' + fullNumber;
            
            window.open(whatsappLink, '_blank');
        }

        populateCountries();
        fetchUserCountry();
    </script>
</body>
</html>
